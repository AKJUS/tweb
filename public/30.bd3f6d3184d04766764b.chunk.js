(this.webpackJsonp=this.webpackJsonp||[]).push([[30],{20:function(e,t,n){"use strict";n.r(t);var a=n(35),o=n(50),c=n(17),i=n(32),s=n(31),r=n(62),d=n(38),l=n(56),u=n(33),p=n(88),h=n(1),b=n(8),m=n(16),f=n(52),g=n(18),v=n(64),L=n(6),y=n(67),E=n(99),O=n(116),j=n(22),_=n(93),w=n(5),k=n(30),S=n(36),T=n(60),x=n(66),C=n(101),N=n(92),P=n(53),I=n(81),A=n(15),D=n(122),H=n(10),M=n(45),R=function(e,t,n,a){return new(n||(n=Promise))((function(o,c){function i(e){try{r(a.next(e))}catch(e){c(e)}}function s(e){try{r(a.throw(e))}catch(e){c(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}r((a=a.apply(e,t||[])).next())}))};let B,U=null;const W=new r.a("page-sign",!0,()=>{const e=()=>{t=m.default.countriesList.filter(e=>{var t;return!(null===(t=e.pFlags)||void 0===t?void 0:t.hidden)}).sort((e,t)=>(e.name||e.default_name).localeCompare(t.name||t.default_name))};let t;e(),A.default.addEventListener("language_change",()=>{e()});const r=new Map;let g,q;const F=document.createElement("div");F.classList.add("input-wrapper");const J=new d.b({label:"Login.CountrySelectorLabel",name:Object(y.b)()});J.container.classList.add("input-select");const K=J.input,V=document.createElement("div");V.classList.add("select-wrapper","z-depth-3","hide");const z=document.createElement("span");z.classList.add("arrow","arrow-down"),J.container.append(z);const Q=document.createElement("ul");V.appendChild(Q);new o.b(V);let $=()=>{$=null,t.forEach(e=>{const t=Object(N.c)(e.iso2),n=[];e.country_codes.forEach(a=>{const o=document.createElement("li");let c=s.a.wrapEmojiText(t);if(H.a){const e=document.createElement("span");e.innerHTML=c,o.append(e)}else o.innerHTML=c;const i=Object(m.i18n)(e.default_name);i.dataset.defaultName=e.default_name,o.append(i);const r=document.createElement("span");r.classList.add("phone-code"),r.innerText="+"+a.country_code,o.appendChild(r),n.push(o),Q.append(o)}),r.set(e.iso2,n)}),Q.addEventListener("mousedown",e=>{if(0!==e.button)return;const t=Object(v.a)(e.target,"LI");G(t)}),J.container.appendChild(V)};const G=e=>{const n=e.childNodes[1].dataset.defaultName,a=e.querySelector(".phone-code").innerText,o=a.replace(/\D/g,"");Object(S.a)(K,Object(m.i18n)(n)),Object(P.a)(K,"input"),g=t.find(e=>e.default_name===n),q=g.country_codes.find(e=>e.country_code===o),te.value=te.lastValue=a,ee(),setTimeout(()=>{ne.focus(),Object(C.a)(ne,!0)},0)};let X;$(),K.addEventListener("focus",(function(e){$?$():t.forEach(e=>{r.get(e.iso2).forEach(e=>e.style.display="")}),clearTimeout(X),X=void 0,V.classList.remove("hide"),V.offsetWidth,V.classList.add("active"),J.select(),Object(p.b)(W.pageEl.parentElement.parentElement,K,"start",4),setTimeout(()=>{Y||(document.addEventListener("mousedown",Z,{capture:!0}),Y=!0)},0)}));let Y=!1;const Z=e=>{Object(L.a)(e.target,"input-select")||e.target!==K&&(ee(),document.removeEventListener("mousedown",Z,{capture:!0}),Y=!1)},ee=()=>{void 0===X&&(V.classList.remove("active"),X=window.setTimeout(()=>{V.classList.add("hide"),X=void 0},200))};K.addEventListener("keyup",e=>{const n=Object(M.a)(e);if(e.ctrlKey||"Control"===n)return!1;let a=J.value.toLowerCase(),o=[];t.forEach(e=>{let t=!![e.name,e.default_name].filter(Boolean).find(e=>-1!==e.toLowerCase().indexOf(a));r.get(e.iso2).forEach(e=>e.style.display=t?"":"none"),t&&o.push(e)}),0===o.length?t.forEach(e=>{r.get(e.iso2).forEach(e=>e.style.display="")}):1===o.length&&"Enter"===n&&G(r.get(o[0].iso2)[0])}),z.addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),K.matches(":focus")?K.blur():K.focus()}));const te=new D.a({onInput:e=>{f.b.loadLottieWorkers();const{country:t,code:n}=e||{};let a=t?t.name||t.default_name:"";a===J.value||g&&t&&n&&(g===t||q.country_code===n.country_code)||(Object(S.a)(K,t?Object(m.i18n)(t.default_name):a),g=t,q=n),t||te.value.length-1>1?U.style.visibility="":U.style.visibility="hidden"}}),ne=te.input;ne.addEventListener("keypress",e=>{if(!U.style.visibility&&"Enter"===Object(M.a)(e))return oe()});const ae=new l.a({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});ae.input.addEventListener("change",()=>{const e=ae.checked;c.default.pushToState("keepSigned",e),E.a.toggleStorage(e),O.a.toggleStorage(e),i.a.toggleStorage(e),x.a.toggleStorage(e)}),c.default.getState().then(e=>{c.default.storage.isAvailable()?ae.checked=e.keepSigned:(ae.checked=!1,ae.label.classList.add("checkbox-disabled"))}),U=Object(u.a)("btn-primary btn-color-primary",{text:"Login.Next"}),U.style.visibility="hidden";const oe=e=>{e&&Object(w.a)(e);const t=Object(T.a)([U,B],!0);Object(S.a)(U,Object(m.i18n)("PleaseWait")),Object(a.f)(U);let o=te.value;i.a.invokeApi("auth.sendCode",{phone_number:o,api_id:b.a.id,api_hash:b.a.hash,settings:{_:"codeSettings"}}).then(e=>{n.e(21).then(n.bind(null,23)).then(t=>t.default.mount(Object.assign(e,{phone_number:o})))}).catch(e=>{switch(t(),e.type){case"PHONE_NUMBER_INVALID":te.setError(),Object(S.a)(te.label,Object(m.i18n)("Login.PhoneLabelInvalid")),ne.classList.add("error"),Object(S.a)(U,Object(m.i18n)("Login.Next"));break;default:console.error("auth.sendCode error:",e),U.innerText=e.type}})};Object(k.b)(U,oe),B=Object(u.a)("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"});B.addEventListener("click",()=>{j.default.mount()}),F.append(J.container,te.container,ae.label,U,B);const ce=document.createElement("h4");ce.classList.add("text-center"),Object(m._i18n)(ce,"Login.Title");const ie=document.createElement("div");ie.classList.add("subtitle","text-center"),Object(m._i18n)(ie,"Login.StartText"),W.pageEl.querySelector(".container").append(ce,ie,F);h.IS_TOUCH_SUPPORTED||setTimeout(()=>{ne.focus()},0),Object(_.a)(F),i.a.invokeApi("help.getNearestDc").then(e=>{var t;const n=I.a.getFromCache("langPack");n&&!(null===(t=n.countries)||void 0===t?void 0:t.hash)&&m.default.getLangPack(n.lang_code).then(()=>{Object(P.a)(ne,"input")});const a=new Set([1,2,3,4,5]),o=[e.this_dc];let c;return e.nearest_dc!==e.this_dc&&(c=i.a.getNetworker(e.nearest_dc).then(()=>{o.push(e.nearest_dc)})),(c||Promise.resolve()).then(()=>{o.forEach(e=>{a.delete(e)});const e=[...a],t=()=>R(void 0,void 0,void 0,(function*(){const n=e.shift();if(!n)return;const a=`dc${n}_auth_key`;if(yield x.a.get(a))return t();setTimeout(()=>{i.a.getNetworker(n).finally(t)},3e3)}));t()}),e}).then(e=>{J.value.length||te.value.length||G(r.get(e.country)[0])})},()=>{U&&(Object(S.a)(U,Object(m.i18n)("Login.Next")),Object(g.ripple)(U,void 0,void 0,!0),U.removeAttribute("disabled")),B&&B.removeAttribute("disabled"),c.default.pushToState("authState",{_:"authStateSignIn"})});t.default=W}}]);
//# sourceMappingURL=30.bd3f6d3184d04766764b.chunk.js.map