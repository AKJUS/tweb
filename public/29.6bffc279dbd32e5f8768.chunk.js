(this.webpackJsonp=this.webpackJsonp||[]).push([[29],{19:function(e,t,n){"use strict";n.r(t);var a=n(33),o=n(45),i=n(16),c=n(30),s=n(29),l=n(62),d=n(38),r=n(50),u=n(31),p=n(0),h=n(80),b=n(1),m=n(7),f=n(14),g=n(46),v=n(17),y=n(59),L=n(5),E=n(66),j=n(91),O=n(101),_=n(21),w=n(87),k=n(4),S=n(28),x=n(34),T=n(52),N=n(57),P=n(97),C=n(84),A=n(92),M=n(47),R=n(75),D=n(15),I=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function c(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}l((a=a.apply(e,t||[])).next())}))};let V,K=null;const B=new l.a("page-sign",!0,()=>{const e=()=>{t=f.default.countriesList.filter(e=>{var t;return!(null===(t=e.pFlags)||void 0===t?void 0:t.hidden)}).sort((e,t)=>(e.name||e.default_name).localeCompare(t.name||t.default_name))};let t;e(),D.default.addEventListener("language_change",()=>{e()});const l=new Map;let v,H;const W=document.createElement("div");W.classList.add("input-wrapper");const q=new d.b({label:"Login.CountrySelectorLabel",name:Object(E.b)()});q.container.classList.add("input-select");const F=q.input,J=document.createElement("div");J.classList.add("select-wrapper","z-depth-3","hide");const z=document.createElement("span");z.classList.add("arrow","arrow-down"),q.container.append(z);const Q=document.createElement("ul");J.appendChild(Q);new o.b(J);let U=()=>{U=null,t.forEach(e=>{const t=Object(A.c)(e.iso2),n=[];e.country_codes.forEach(a=>{const o=document.createElement("li");let i=s.a.wrapEmojiText(t);if(s.a.emojiSupported){const e=document.createElement("span");e.innerHTML=i,o.append(e)}else o.innerHTML=i;const c=Object(f.i18n)(e.default_name);c.dataset.defaultName=e.default_name,o.append(c);const l=document.createElement("span");l.classList.add("phone-code"),l.innerText="+"+a.country_code,o.appendChild(l),n.push(o),Q.append(o)}),l.set(e.iso2,n)}),Q.addEventListener("mousedown",e=>{if(0!==e.button)return;const t=Object(y.a)(e.target,"LI");$(t)}),q.container.appendChild(J)};const $=e=>{const n=e.childNodes[1].dataset.defaultName,a=e.querySelector(".phone-code").innerText,o=a.replace(/\D/g,"");Object(x.a)(F,Object(f.i18n)(n)),Object(M.a)(F,"input"),v=t.find(e=>e.default_name===n),H=v.country_codes.find(e=>e.country_code===o),ne.value=te=a,Z(),setTimeout(()=>{ae.focus(),Object(P.a)(ae,!0)},0)};let G;U(),F.addEventListener("focus",(function(e){U?U():t.forEach(e=>{l.get(e.iso2).forEach(e=>e.style.display="")}),clearTimeout(G),G=void 0,J.classList.remove("hide"),J.offsetWidth,J.classList.add("active"),q.select(),Object(h.b)(B.pageEl.parentElement.parentElement,F,"start",4),setTimeout(()=>{X||(document.addEventListener("mousedown",Y,{capture:!0}),X=!0)},0)}));let X=!1;const Y=e=>{Object(L.a)(e.target,"input-select")||e.target!==F&&(Z(),document.removeEventListener("mousedown",Y,{capture:!0}),X=!1)},Z=()=>{void 0===G&&(J.classList.remove("active"),G=window.setTimeout(()=>{J.classList.add("hide"),G=void 0},200))};F.addEventListener("keyup",e=>{if(e.ctrlKey||"Control"===e.key)return!1;let n=q.value.toLowerCase(),a=[];t.forEach(e=>{let t=!![e.name,e.default_name].filter(Boolean).find(e=>-1!==e.toLowerCase().indexOf(n));l.get(e.iso2).forEach(e=>e.style.display=t?"":"none"),t&&a.push(e)}),0===a.length?t.forEach(e=>{l.get(e.iso2).forEach(e=>e.style.display="")}):1===a.length&&"Enter"===e.key&&$(l.get(a[0].iso2)[0])}),z.addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),F.matches(":focus")?F.blur():F.focus()}));let ee=!1,te="";const ne=new d.b({label:"Login.PhoneLabel",name:"phone"});ne.container.classList.add("input-field-phone");let ae=ne.input;if(ae instanceof HTMLInputElement)ae.type="tel",ae.autocomplete="rr55RandomRR55";else{ae.inputMode="decimal";const e=window.devicePixelRatio;if(e>1){let t;p.isApple?t=-.16*e:p.isAndroid&&(t=0),ae.style.setProperty("--letter-spacing",t+"px")}const t=ne.setValueSilently.bind(ne);ne.setValueSilently=e=>{t(e),Object(P.a)(ne.input,!0)}}ae.addEventListener("input",()=>{ae.classList.remove("error"),g.b.loadLottieWorkers();const e=ne.value;Math.abs(e.length-te.length)>1&&!ee&&p.isAppleMobile&&ne.setValueSilently(te+e),ee=!1,ne.setLabel();let t,n,a,o="";if("+"===ne.value.replace(/\++/,"+"))ne.setValueSilently("+");else{const e=Object(C.a)(ne.value);t=e.formatted,n=e.country,o=e.leftPattern,a=e.code,ne.setValueSilently(te=t?"+"+t:"")}ae.dataset.leftPattern=o;let i=n?n.name||n.default_name:"";i===q.value||v&&n&&a&&(v===n||H.country_code===a.country_code)||(Object(x.a)(F,n?Object(f.i18n)(n.default_name):i),v=n,H=a),n||ne.value.length-1>1?K.style.visibility="":K.style.visibility="hidden"}),ae.addEventListener("paste",()=>{ee=!0}),ae.addEventListener("keypress",e=>K.style.visibility||"Enter"!==e.key?!/\D/.test(e.key)||e.metaKey||e.ctrlKey||"Backspace"===e.key||"+"===e.key&&e.shiftKey?void 0:(e.preventDefault(),!1):ie());const oe=new r.a({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});oe.input.addEventListener("change",()=>{const e=oe.checked;i.default.pushToState("keepSigned",e),j.a.toggleStorage(e),O.a.toggleStorage(e),c.a.toggleStorage(e),N.a.toggleStorage(e)}),i.default.getState().then(e=>{i.default.storage.isAvailable()?oe.checked=e.keepSigned:(oe.checked=!1,oe.label.classList.add("checkbox-disabled"))}),K=Object(u.a)("btn-primary btn-color-primary",{text:"Login.Next"}),K.style.visibility="hidden";const ie=e=>{e&&Object(k.a)(e);const t=Object(T.a)([K,V],!0);Object(x.a)(K,Object(f.i18n)("PleaseWait")),Object(a.f)(K);let o=ne.value;c.a.invokeApi("auth.sendCode",{phone_number:o,api_id:m.a.id,api_hash:m.a.hash,settings:{_:"codeSettings"}}).then(e=>{n.e(22).then(n.bind(null,22)).then(t=>t.default.mount(Object.assign(e,{phone_number:o})))}).catch(e=>{switch(t(),e.type){case"PHONE_NUMBER_INVALID":ne.setError(),Object(x.a)(ne.label,Object(f.i18n)("Login.PhoneLabelInvalid")),ae.classList.add("error"),Object(x.a)(K,Object(f.i18n)("Login.Next"));break;default:console.error("auth.sendCode error:",e),K.innerText=e.type}})};Object(S.b)(K,ie),V=Object(u.a)("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"});V.addEventListener("click",()=>{_.default.mount()}),W.append(q.container,ne.container,oe.label,K,V);const ce=document.createElement("h4");ce.classList.add("text-center"),Object(f._i18n)(ce,"Login.Title");const se=document.createElement("div");se.classList.add("subtitle","text-center"),Object(f._i18n)(se,"Login.StartText"),B.pageEl.querySelector(".container").append(ce,se,W);b.isTouchSupported||setTimeout(()=>{ae.focus()},0),Object(w.a)(W),c.a.invokeApi("help.getNearestDc").then(e=>{var t;const n=R.a.getFromCache("langPack");n&&!(null===(t=n.countries)||void 0===t?void 0:t.hash)&&f.default.getLangPack(n.lang_code).then(()=>{Object(M.a)(ae,"input")});const a=new Set([1,2,3,4,5]),o=[e.this_dc];let i;return e.nearest_dc!==e.this_dc&&(i=c.a.getNetworker(e.nearest_dc).then(()=>{o.push(e.nearest_dc)})),(i||Promise.resolve()).then(()=>{o.forEach(e=>{a.delete(e)});const e=[...a],t=()=>I(void 0,void 0,void 0,(function*(){const n=e.shift();if(!n)return;const a=`dc${n}_auth_key`;if(yield N.a.get(a))return t();setTimeout(()=>{c.a.getNetworker(n).finally(t)},3e3)}));t()}),e}).then(e=>{q.value.length||ne.value.length||$(l.get(e.country)[0])})},()=>{K&&(Object(x.a)(K,Object(f.i18n)("Login.Next")),Object(v.ripple)(K,void 0,void 0,!0),K.removeAttribute("disabled")),V&&V.removeAttribute("disabled"),i.default.pushToState("authState",{_:"authStateSignIn"})});t.default=B}}]);
//# sourceMappingURL=29.6bffc279dbd32e5f8768.chunk.js.map