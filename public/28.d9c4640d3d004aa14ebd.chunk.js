(this.webpackJsonp=this.webpackJsonp||[]).push([[28],{19:function(e,t,n){"use strict";n.r(t);var a=n(35),o=n(42),i=n(111),s=n(16),l=n(29),c=n(28),r=n(61),d=n(36),u=n(46),p=n(32),h=n(0),b=n(75),m=n(1),f=n(6),v=n(53),y=n(14),g=n(47),L=n(17),E=n(54),j=n(5),w=n(69),O=n(92),S=n(83),k=n(21),x=n(85),T=n(4),C=n(30),_=n(33),P=n(49),N=n(60),A=n(86),I=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function s(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}c((a=a.apply(e,t||[])).next())}))};let M,R=null;const V=new r.a("page-sign",!0,()=>{v.a.test&&(i.b.push({name:"Test Country",phoneCode:"999 66",code:"TC",emoji:"ðŸ¤”",pattern:"999 66 XXX XX"}),console.log("Added test country to list!"));const e=i.b.filter(e=>e.emoji).sort((e,t)=>e.name.localeCompare(t.name));let t=null;const r=document.createElement("div");r.classList.add("input-wrapper");const L=new d.b({label:"Login.CountrySelectorLabel",name:Object(w.b)(),plainText:!0});L.container.classList.add("input-select");const D=L.input;D.autocomplete=Object(w.b)();const K=document.createElement("div");K.classList.add("select-wrapper","z-depth-3","hide");const X=document.createElement("span");X.classList.add("arrow","arrow-down"),L.container.append(X);const H=document.createElement("ul");K.appendChild(H);new o.b(K);let B=()=>{B=null,e.forEach(e=>{const t=e.emoji,n=[];e.phoneCode.split(" and ").forEach(a=>{const o=document.createElement("li");let i=c.a.wrapEmojiText(t);if(c.a.emojiSupported){const e=document.createElement("span");e.innerHTML=i,o.append(e)}else o.innerHTML=i;o.append(e.name);const s=document.createElement("span");s.classList.add("phone-code"),s.innerText="+"+a,o.appendChild(s),n.push(o),H.append(o)}),e.li=n}),H.addEventListener("mousedown",e=>{if(0!==e.button)return;let t=e.target;"LI"!==t.tagName&&(t=Object(E.a)(t,"LI")),W(t)}),L.container.appendChild(K)};const W=n=>{const a=n.childNodes[1].textContent,o=n.querySelector(".phone-code").innerText;D.value=a,t=e.find(e=>e.name===a),F.value=$=o,Q(),setTimeout(()=>{G.focus(),Object(A.a)(G,!0)},0)};let q;B(),D.addEventListener("focus",(function(t){B?B():e.forEach(e=>{e.li.forEach(e=>e.style.display="")}),clearTimeout(q),q=void 0,K.classList.remove("hide"),K.offsetWidth,K.classList.add("active"),L.select(),Object(b.b)(V.pageEl.parentElement.parentElement,D,"start",4),setTimeout(()=>{J||(document.addEventListener("mousedown",z,{capture:!0}),J=!0)},0)}));let J=!1;const z=e=>{Object(j.a)(e.target,"input-select")||e.target!==D&&(Q(),document.removeEventListener("mousedown",z,{capture:!0}),J=!1)},Q=()=>{void 0===q&&(K.classList.remove("active"),q=window.setTimeout(()=>{K.classList.add("hide"),q=void 0},200))};D.addEventListener("keyup",(function(t){if(t.ctrlKey||"Control"===t.key)return!1;let n=this.value.toLowerCase(),a=[];e.forEach(e=>{let t=-1!==e.name.toLowerCase().indexOf(n);e.li.forEach(e=>e.style.display=t?"":"none"),t&&a.push(e)}),0===a.length?e.forEach(e=>{e.li.forEach(e=>e.style.display="")}):1===a.length&&"Enter"===t.key&&W(a[0].li[0])})),X.addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),D.matches(":focus")?D.blur():D.focus()}));let U=!1,$="";const F=new d.b({label:"Login.PhoneLabel",name:"phone"});F.container.classList.add("input-field-phone");let G=F.input;if(G instanceof HTMLInputElement)G.type="tel",G.autocomplete="rr55RandomRR55";else{G.inputMode="decimal";const e=window.devicePixelRatio;if(e>1){let t;h.isApple?t=-.16*e:h.isAndroid&&(t=0),G.style.setProperty("--letter-spacing",t+"px")}const t=F.setValueSilently.bind(F);F.setValueSilently=e=>{t(e),Object(A.a)(F.input,!0)}}G.addEventListener("input",()=>{G.classList.remove("error"),g.b.loadLottieWorkers();const e=F.value;Math.abs(e.length-$.length)>1&&!U&&h.isAppleMobile&&F.setValueSilently($+e),U=!1,F.setLabel();let n,o,i="";if("+"===F.value.replace(/\++/,"+"))F.setValueSilently("+");else{const e=Object(a.d)(F.value);n=e.formatted,o=e.country,i=e.leftPattern,F.setValueSilently($=n?"+"+n:"")}G.dataset.leftPattern=i;let s=o?o.name:"";s===D.value||t&&o&&t.phoneCode===o.phoneCode||(D.value=s,t=o),o||F.value.length-1>1?R.style.visibility="":R.style.visibility="hidden"}),G.addEventListener("paste",()=>{U=!0}),G.addEventListener("keypress",e=>R.style.visibility||"Enter"!==e.key?!/\D/.test(e.key)||e.metaKey||e.ctrlKey||"Backspace"===e.key||"+"===e.key&&e.shiftKey?void 0:(e.preventDefault(),!1):Z());const Y=new u.a({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});Y.input.addEventListener("change",()=>{const e=Y.checked;s.default.pushToState("keepSigned",e),O.a.toggleStorage(e),S.a.toggleStorage(e),l.a.toggleStorage(e),N.a.toggleStorage(e)}),s.default.getState().then(e=>{s.default.storage.isAvailable()?Y.checked=e.keepSigned:(Y.checked=!1,Y.label.classList.add("checkbox-disabled"))}),R=Object(p.a)("btn-primary btn-color-primary",{text:"Login.Next"}),R.style.visibility="hidden";const Z=e=>{e&&Object(T.a)(e);const t=Object(P.a)([R,M],!0);Object(_.a)(R,Object(y.i18n)("PleaseWait")),Object(a.g)(R);let o=F.value;l.a.invokeApi("auth.sendCode",{phone_number:o,api_id:f.a.id,api_hash:f.a.hash,settings:{_:"codeSettings"}}).then(e=>{n.e(23).then(n.bind(null,22)).then(t=>t.default.mount(Object.assign(e,{phone_number:o})))}).catch(e=>{switch(t(),e.type){case"PHONE_NUMBER_INVALID":F.setError(),Object(_.a)(F.label,Object(y.i18n)("Login.PhoneLabelInvalid")),G.classList.add("error"),Object(_.a)(R,Object(y.i18n)("Login.Next"));break;default:console.error("auth.sendCode error:",e),R.innerText=e.type}})};Object(C.b)(R,Z),M=Object(p.a)("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"});M.addEventListener("click",()=>{k.default.mount()}),r.append(L.container,F.container,Y.label,R,M);const ee=document.createElement("h4");ee.classList.add("text-center"),Object(y._i18n)(ee,"Login.Title");const te=document.createElement("div");te.classList.add("subtitle","text-center"),Object(y._i18n)(te,"Login.StartText"),V.pageEl.querySelector(".container").append(ee,te,r);m.isTouchSupported||setTimeout(()=>{G.focus()},0),Object(x.a)(r),l.a.invokeApi("help.getNearestDc").then(e=>{const t=new Set([1,2,3,4,5]),n=[e.this_dc];let a;return e.nearest_dc!==e.this_dc&&(a=l.a.getNetworker(e.nearest_dc).then(()=>{n.push(e.nearest_dc)})),(a||Promise.resolve()).then(()=>{n.forEach(e=>{t.delete(e)});const e=[...t],a=()=>I(void 0,void 0,void 0,(function*(){const t=e.shift();if(!t)return;const n=`dc${t}_auth_key`;if(yield N.a.get(n))return a();setTimeout(()=>{l.a.getNetworker(t).finally(a)},3e3)}));a()}),e}).then(n=>{if(!D.value.length&&!F.value.length){const o=e.find(e=>e.code===n.country);if(o){D.value=o.name,t=o;const e="+"+o.phoneCode.split(" and ").shift(),{leftPattern:n}=Object(a.d)(e);F.setValueSilently($=e),G.dataset.leftPattern=n}}})},()=>{R&&(Object(_.a)(R,Object(y.i18n)("Login.Next")),Object(L.ripple)(R,void 0,void 0,!0),R.removeAttribute("disabled")),M&&M.removeAttribute("disabled"),s.default.pushToState("authState",{_:"authStateSignIn"})});t.default=V}}]);
//# sourceMappingURL=28.d9c4640d3d004aa14ebd.chunk.js.map