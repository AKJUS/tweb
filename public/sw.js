var serviceWorkerOption = {"assets":["/0.e81ea311441f5f54be9d.chunk.js","/1.cf406d0cd68ffe21bb47.chunk.js","/1.d4b422fae4815efd37da.chunk.worker.js","/10.0b289118bb9e1d8c446c.chunk.js","/11.4997b19945d6ad14f41e.chunk.js","/12.4fa0ab8c485c5a65c3f4.chunk.js","/13.185d59a6ddc0c276933d.chunk.js","/14.43216ada7664a1093d4f.chunk.js","/15.b55225315846ce0c47d4.chunk.js","/16.88d970389655734ca921.chunk.js","/17.4c08fa2b78ccd5455535.chunk.js","/18.e8bdf74371cc40f5e460.chunk.js","/19.f1478a9b21080ebfe726.chunk.js","/2.1dda105b0b11d4c48360.chunk.js","/20.ded8e518877992c77dc4.chunk.js","/21.000c96a58ce0a7cb888f.chunk.js","/22.aeec566414c07891928e.chunk.js","/23.2e0dc626a8d4194d0d6f.chunk.js","/24.daa6793caaabc554eb34.chunk.js","/25.f2ae5526236f3f610fef.chunk.js","/26.ae5a70d9b018eba1fa17.chunk.js","/27.395925b87184ba8c545e.chunk.js","/3.751c8a8b65cfea6b4dc9.chunk.js","/4.76ff73b569396ccc73e8.chunk.js","/5.75216de16e92b3a3bb12.chunk.js","/6.26a6b176e44656a7fe94.chunk.js","/7.d9f9ff8b4c25b0932fec.chunk.js","/main.22bf291a899db75bb3ab.css","/main.b4b51fdb66e3ff06e30a.bundle.js","/mtproto.worker.151a5a2ca6d2305b0b2e.bundle.worker.js","/npm.qr-code-styling.ccc7022197ac4bc70fcb.chunk.js","/rlottie.worker.6777ef401e7048467332.bundle.worker.js","/style-desktop.9d7b485ed526720a3aad.css","/webp.worker.bd598dc02a03fd59d71a.bundle.worker.js"]};
        
        !function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"log",(function(){return C})),n.d(t,"deferredPromises",(function(){return q})),n.d(t,"getTaskId",(function(){return U})),n.d(t,"incrementTaskId",(function(){return F}));var o={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,multipleConnections:!0,asServiceWorker:!1};const r=o.debug;"undefined"!=typeof window?window:self;var i,s=r;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Log=4]="Log",e[e.Debug=8]="Debug"}(i||(i={}));const a=[i.None,i.Error,i.Warn,i.Log,i.Debug],c=Date.now();function l(){return"["+((Date.now()-c)/1e3).toFixed(3)+"]"}function u(e,t=i.Log|i.Warn|i.Error){function n(...n){return t&i.Log&&console.log(l(),e,...n)}return s||(t=i.Error),n.warn=function(...n){return t&i.Warn&&console.warn(l(),e,...n)},n.info=function(...n){return t&i.Log&&console.info(l(),e,...n)},n.error=function(...n){return t&i.Error&&console.error(l(),e,...n)},n.trace=function(...n){return t&i.Log&&console.trace(l(),e,...n)},n.debug=function(...n){return t&i.Debug&&console.debug(l(),e,...n)},n.setPrefix=function(t){e="["+t+"]:"},n.setPrefix(e),n.setLevel=function(e){t=a.slice(0,e+1).reduce((e,t)=>e|t,0)},n}var d={name:"tweb",version:7,stores:[{name:"session"},{name:"stickerSets"},{name:"users"},{name:"chats"},{name:"dialogs"},{name:"messages"}]};const f=navigator?navigator.userAgent:null,h=(navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i),navigator.userAgent.toLowerCase().indexOf("android"),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),"undefined"!=typeof window?window:self),g=((/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&h.MSStream,!!("safari"in h)||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))),p=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i);class m{constructor(e,t){this.storageIsAvailable=!0,function(e,t){if(t)for(let n in t)void 0!==t[n]&&(e[n]=t[n])}(this,e),o.test&&(this.name+="_test"),this.storeName=t,this.log=u("IDB-"+this.storeName),this.openDatabase(!0),m.STORAGES.push(this)}static closeDatabases(){this.STORAGES.forEach(e=>{const t=e.db;t&&(t.onclose=()=>{},t.close())})}static deleteDatabase(){this.closeDatabases();const e=this.STORAGES,t=Array.from(new Set(e.map(e=>e.name))).map(e=>new Promise((t,n)=>{const o=indexedDB.deleteDatabase(e);o.onerror=()=>{n()},o.onsuccess=()=>{t()}}));return Promise.all(t)}isAvailable(){return this.storageIsAvailable}openDatabase(e=!1){if(this.openDbPromise&&!e)return this.openDbPromise;try{var t=indexedDB.open(this.name,this.version);if(!t)return Promise.reject()}catch(e){return this.log.error("error opening db",e.message),this.storageIsAvailable=!1,Promise.reject(e)}let n=!1;return setTimeout(()=>{n||t.onerror({type:"IDB_CREATE_TIMEOUT"})},3e3),this.openDbPromise=new Promise((e,o)=>{t.onsuccess=r=>{n=!0;const i=t.result;let s=!1;this.log("Opened"),i.onerror=e=>{this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",e),o(e)},i.onclose=e=>{this.log.error("closed:",e),!s&&this.openDatabase()},i.onabort=e=>{this.log.error("abort:",e);const t=e.target;this.openDatabase(s=!0),t.onerror&&t.onerror(e),i.close()},i.onversionchange=e=>{this.log.error("onversionchange, lol?")},e(this.db=i)},t.onerror=e=>{n=!0,this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",e),o(e)},t.onupgradeneeded=e=>{n=!0,this.log.warn("performing idb upgrade from",e.oldVersion,"to",e.newVersion);var t=e.target.result;this.stores.forEach(e=>{t.objectStoreNames.contains(e.name)||((e,t)=>{var n;const o=e.createObjectStore(t.name);if(null===(n=t.indexes)||void 0===n?void 0:n.length)for(const e of t.indexes)o.createIndex(e.indexName,e.keyPath,e.objectParameters)})(t,e)})}})}delete(e){return Array.isArray(e)||(e=[].concat(e)),this.getObjectStore("readwrite",t=>e.map(e=>t.delete(e)),"")}deleteAll(){return this.getObjectStore("readwrite",e=>e.clear(),"")}save(e,t){return Array.isArray(e)||(e=[].concat(e),t=[].concat(t)),this.getObjectStore("readwrite",n=>e.map((e,o)=>n.put(t[o],e)),"")}saveFile(e,t){return t instanceof Blob||(t=function(e,t=""){let n;const o=function(e){if(-1===["image/jpeg","image/png","image/gif","image/webp","image/bmp","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","application/json","application/pdf"].indexOf(e))return"application/octet-stream";return e}(t);try{n=new Blob(e,{type:o})}catch(t){let r=new BlobBuilder;e.forEach(e=>{r.append(e)}),n=r.getBlob(o)}return n}([t])),this.save(e,t)}get(e){return Array.isArray(e)||(e=[].concat(e)),this.getObjectStore("readonly",t=>e.map(e=>t.get(e)),"")}getObjectStore(e,t,n){let o;return n&&(o=performance.now(),this.log(n+": start")),this.openDatabase().then(r=>new Promise((i,s)=>{const a=r.transaction([this.storeName],e);a.onerror=e=>{clearTimeout(c),s(a.error)},a.oncomplete=e=>{clearTimeout(c),n&&this.log(n+": end",performance.now()-o);const t=d.map(e=>e.result);i(u?t:t[0])};const c=setTimeout(()=>{this.log.error("transaction not finished",a)},1e4),l=t(a.objectStore(this.storeName)),u=Array.isArray(l),d=u?l:[].concat(l)}))}getAll(){return this.getObjectStore("readonly",e=>e.getAll(),"")}}m.STORAGES=[];var b=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const v=self,y=location.protocol+"//"+location.hostname+location.pathname.split("/").slice(0,-1).join("/")+"/";const w=new class{constructor(e,t,n){this.defaults=n,this.cache={},this.storage=new m(e,t)}get(e){return b(this,void 0,void 0,(function*(){if(void 0!==this.cache[e])return this.cache[e];let t;try{t=yield this.storage.get(e)}catch(e){}if(void 0!==this.cache[e])return this.cache[e];if(void 0===t){const n=this.defaults[e];t="function"==typeof n?n():n}return this.cache[e]=t}))}set(e,t){return b(this,void 0,void 0,(function*(){this.cache[e]=t;try{this.storage.save(e,t)}catch(e){}}))}}(d,"session",{push_mute_until:0,push_last_alive:0,push_lang:{},push_settings:{}});v.addEventListener("push",e=>{const t=e.data.json();C("push",t);let n=!1;const o=Promise.all([w.get("push_mute_until"),w.get("push_last_alive"),v.clients.matchAll({type:"window"})]).then(e=>{const[o,r,i]=e;if(C("matched clients",i),n=i.length>0,n)throw"Supress notification because some instance is alive";const s=Date.now();if(j()&&o&&s<o)throw`Supress notification because mute for ${Math.ceil((o-s)/6e4)} min`;if(!t.badge)throw"No badge?"});o.catch(e=>{C(e)});const r=o.then(()=>Promise.all([w.get("push_settings"),w.get("push_lang")])).then(e=>function(e,t,n){const o="assets/img/logo_filled_rounded.png";let r,i=e.title||"Telegram",s=e.description||"";e.custom&&(r=e.custom.channel_id?-e.custom.channel_id:e.custom.chat_id?-e.custom.chat_id:+e.custom.from_id||0);e.custom.peerId=""+r;let a="peer"+r;t&&t.nopreview&&(i="Telegram",s=n.push_message_nopreview||"You have a new message",a="unknown_peer");C("show notify",i,s,o,e);const c=[{action:"mute1d",title:n.push_action_mute1d||"Mute for 24H"}];return v.registration.showNotification(i,{body:s,icon:o,tag:a,data:e,actions:c}).then(e=>{var t;e&&e.notification&&(t=e.notification,P.has(t)||(P.add(t),t.onclose=_))}).catch(e=>{C.error("Show notification promise",e)})}(t,e[0],e[1])).catch(()=>(C("Closing all notifications on push",n),j()||n?A():v.registration.showNotification("Telegram",{tag:"unknown_peer"}).then(()=>{if(n)return A();setTimeout(()=>A(),n?0:100)}).catch(e=>{C.error("Show notification error",e)})));e.waitUntil(r)}),v.addEventListener("notificationclick",e=>{const t=e.notification;C("On notification click: ",t.tag),t.close();const n=e.action;if("mute1d"===n&&j())return C("[SW] mute for 1d"),void w.set("push_mute_until",Date.now()+864e5);const o=t.data;if(!o)return;const r=v.clients.matchAll({type:"window"}).then(e=>{o.action=n,S={type:"push_click",payload:o};for(let t=0;t<e.length;t++){const n=e[t];if("focus"in n)return n.focus(),n.postMessage(S),void(S=void 0)}if(v.clients.openWindow)return w.get("push_settings").then(e=>v.clients.openWindow(e.baseUrl||y))}).catch(e=>{C.error("Clients.matchAll error",e)});e.waitUntil(r)}),v.addEventListener("notificationclose",_);let S,P=new Set;function _(e){var t;t=e.notification,P.delete(t)}function A(){for(const e of P)try{e.close()}catch(e){}let e;return e="getNotifications"in v.registration?v.registration.getNotifications({}).then(e=>{for(let t=0,n=e.length;t<n;++t)try{e[t].close()}catch(e){}}).catch(e=>{C.error("Offline register SW error",e)}):Promise.resolve(),P.clear(),e}function j(){return p}var O=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const x=self;function T(e){return e.ok&&200===e.status}const D="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,E="undefined"!=typeof ServiceWorkerGlobalScope&&self instanceof ServiceWorkerGlobalScope,L=(e,...t)=>{self.clients.matchAll({includeUncontrolled:!1,type:"window"}).then(n=>{n.length&&n.slice(e?0:-1).forEach(e=>{e.postMessage(...t)})})},N=(...e)=>{self.postMessage(...e)},M=()=>{},W=E?L.bind(null,!1):D?N:M;E&&L.bind(null,!0);function I(e,t){const n=function(e){if(!e)return[0,0];const[,t]=e.split("="),n=t.split(", "),[o,r]=n[0].split("-");return[+o,+r||0]}(e.request.headers.get("Range"));let[o,r]=n;const i=JSON.parse(decodeURIComponent(t)),s=i.size>78643200?k:R;var a;e.respondWith(Promise.race([(a=45e3,new Promise(e=>{setTimeout(()=>{e(new Response("",{status:408,statusText:"Request timed out."}))},a)})),new Promise((e,t)=>{const a=function(e,t,n){if(0===e[0]&&1===e[1])return new Response(new Uint8Array(2).buffer,{status:206,statusText:"Partial Content",headers:{"Accept-Ranges":"bytes","Content-Range":"bytes 0-1/"+(n||"*"),"Content-Length":"2","Content-Type":t||"video/mp4"}});return null}(n,i.mimeType,i.size);if(a)return e(a);const c=r&&r<s?function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}(r-o+1):s,l=function(e,t=2048){return e-e%t}(o,c),u={type:"requestFilePart",id:F(),payload:[i.dcId,i.location,l,c]};(q[u.id]=function(){let e={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:(...t)=>{e.lastNotify=t,e.listeners.forEach(e=>e(...t))},lastNotify:void 0,listeners:[],addNotifyListener:t=>{e.lastNotify&&t(...e.lastNotify),e.listeners.push(t)}},t=new Promise((n,o)=>{e.resolve=e=>{t.isFulfilled||(t.isFulfilled=!0,n(e))},e.reject=(...e)=>{t.isRejected||(t.isRejected=!0,o(...e))}});return t.finally(()=>{t.notify=null,t.listeners.length=0,t.lastNotify=null,t.cancel&&(t.cancel=()=>{})}),Object.assign(t,e),t}()).then(t=>{let n=t.bytes;const s={"Accept-Ranges":"bytes","Content-Range":`bytes ${l}-${l+n.byteLength-1}/${i.size||"*"}`,"Content-Length":""+n.byteLength};i.mimeType&&(s["Content-Type"]=i.mimeType),g&&(n=n.slice(o-l,r-l+1),s["Content-Range"]=`bytes ${o}-${o+n.byteLength-1}/${i.size||"*"}`,s["Content-Length"]=""+n.byteLength),e(new Response(n,{status:206,statusText:"Partial Content",headers:s}))}).catch(e=>{}),W(u)})]))}const R=524288,k=1048576;const C=u("SW",i.Error|i.Debug|i.Log|i.Warn),B=self,q={},$={notifications_clear:()=>{A()},ping:(e,t)=>{!function(e,t){const n=t.ports&&t.ports[0]||t.source,o=e.payload;o.localNotifications&&w.set("push_last_alive",Date.now()),S&&n&&"postMessage"in n&&(n.postMessage(S,[]),S=void 0),o.lang&&w.set("push_lang",o.lang),o.settings&&w.set("push_settings",o.settings)}(e,t)},requestFilePart:e=>{const t=q[e.id];e.error?t.reject(e.error):t.resolve(e.payload),delete q[e.id]}};B.addEventListener("message",e=>{const t=e.data,n=$[t.type];n&&n(t,e)});let G=0;function U(){return G}function F(){return G++}const z=e=>{if(0===e.request.url.indexOf(location.origin+"/")&&e.request.url.match(/\.(js|css|jpe?g|json|wasm|png|mp3|svg|tgs|ico|woff2?|ttf|webmanifest?)(?:\?.*)?$/))return e.respondWith(function(e){return O(this,void 0,void 0,(function*(){try{const t=yield x.caches.open("cachedAssets"),n=yield t.match(e.request,{ignoreVary:!0});if(n&&T(n))return n;const o={Vary:"*"};let r=yield fetch(e.request,{headers:o});if(T(r))t.put(e.request,r.clone());else if(304===r.status){const n=e.request.url.replace(/\?.+$/,"")+"?"+(1e5*Math.random()|0);r=yield fetch(n,{headers:o}),T(r)&&t.put(e.request,r.clone())}return r}catch(t){return fetch(e.request)}}))}(e));try{const[,t,n,o]=/http[:s]+\/\/.*?(\/(.*?)(?:$|\/(.*)$))/.exec(e.request.url)||[];switch(n){case"stream":I(e,o)}}catch(t){e.respondWith(new Response("",{status:500,statusText:"Internal Server Error"}))}},V=()=>{B.onfetch=z};B.addEventListener("install",e=>{C("installing"),e.waitUntil(B.skipWaiting())}),B.addEventListener("activate",e=>{C("activating",B),e.waitUntil(B.caches.delete("cachedAssets")),e.waitUntil(B.clients.claim())}),B.onerror=e=>{C.error("error:",e)},B.onunhandledrejection=e=>{C.error("onunhandledrejection:",e)},B.onoffline=B.ononline=V,V()}]);
//# sourceMappingURL=sw.js.map