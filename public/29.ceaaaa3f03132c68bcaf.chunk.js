(this.webpackJsonp=this.webpackJsonp||[]).push([[29],{18:function(e,t,n){"use strict";n.r(t);var a=n(35),o=n(42),i=n(105),s=n(14),c=n(28),l=n(27),r=n(59),d=n(36),u=n(45),p=n(31),h=n(0),b=n(71),m=n(15),v=n(4),f=n(53),g=n(12),y=n(46),L=n(16),E=n(54),j=n(3),w=n(68),k=n(87),O=n(80),S=n(20),T=n(82),x=n(2),C=n(29),_=n(33),N=n(48),A=n(58),I=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function s(e){try{l(a.next(e))}catch(e){i(e)}}function c(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}l((a=a.apply(e,t||[])).next())}))};let P,R=null;const D=new r.a("page-sign",!0,()=>{f.a.test&&(i.b.push({name:"Test Country",phoneCode:"999 66",code:"TC",emoji:"ðŸ¤”",pattern:"999 66 XXX XX"}),console.log("Added test country to list!"));const e=i.b.filter(e=>e.emoji).sort((e,t)=>e.name.localeCompare(t.name));let t=null;const r=document.createElement("div");r.classList.add("input-wrapper");const L=new d.b({label:"Login.CountrySelectorLabel",name:Object(w.b)(),plainText:!0});L.container.classList.add("input-select");const K=L.input;K.autocomplete=Object(w.b)();const M=document.createElement("div");M.classList.add("select-wrapper","z-depth-3","hide");const X=document.createElement("span");X.classList.add("arrow","arrow-down"),L.container.append(X);const B=document.createElement("ul");M.appendChild(B);new o.b(M);let H=()=>{H=null,e.forEach(e=>{const t=e.emoji,n=[];e.phoneCode.split(" and ").forEach(a=>{const o=document.createElement("li");let i=l.a.wrapEmojiText(t);if(l.a.emojiSupported){const e=document.createElement("span");e.innerHTML=i,o.append(e)}else o.innerHTML=i;o.append(e.name);const s=document.createElement("span");s.classList.add("phone-code"),s.innerText="+"+a,o.appendChild(s),n.push(o),B.append(o)}),e.li=n}),B.addEventListener("mousedown",e=>{if(0!==e.button)return;let t=e.target;"LI"!==t.tagName&&(t=Object(E.a)(t,"LI")),W(t)}),L.container.appendChild(M)};const W=n=>{const a=n.childNodes[1].textContent,o=n.querySelector(".phone-code").innerText;K.value=a,t=e.find(e=>e.name===a),F.value=V=o,Q(),setTimeout(()=>F.focus(),0)};let q;H(),K.addEventListener("focus",(function(t){H?H():e.forEach(e=>{e.li.forEach(e=>e.style.display="")}),clearTimeout(q),q=void 0,M.classList.remove("hide"),M.offsetWidth,M.classList.add("active"),L.select(),Object(b.b)(D.pageEl.parentElement.parentElement,K,"start",4),setTimeout(()=>{J||(document.addEventListener("mousedown",z,{capture:!0}),J=!0)},0)}));let J=!1;const z=e=>{Object(j.a)(e.target,"input-select")||e.target!==K&&(Q(),document.removeEventListener("mousedown",z,{capture:!0}),J=!1)},Q=()=>{void 0===q&&(M.classList.remove("active"),q=window.setTimeout(()=>{M.classList.add("hide"),q=void 0},200))};K.addEventListener("keyup",(function(t){if(t.ctrlKey||"Control"===t.key)return!1;let n=this.value.toLowerCase(),a=[];e.forEach(e=>{let t=-1!==e.name.toLowerCase().indexOf(n);e.li.forEach(e=>e.style.display=t?"":"none"),t&&a.push(e)}),0===a.length?e.forEach(e=>{e.li.forEach(e=>e.style.display="")}):1===a.length&&"Enter"===t.key&&W(a[0].li[0])})),X.addEventListener("mousedown",(function(e){e.cancelBubble=!0,e.preventDefault(),K.matches(":focus")?K.blur():K.focus()}));let U=!1,V="";const $=new d.b({label:"Login.PhoneLabel",plainText:!0,name:"phone"});let F=$.input;F.type="tel",F.autocomplete="rr55RandomRR55",F.addEventListener("input",(function(e){this.classList.remove("error"),y.b.loadLottieWorkers();const n=this.value;let o,i;if(Math.abs(n.length-V.length)>1&&!U&&h.isAppleMobile&&(this.value=V+n),U=!1,$.setLabel(),"+"===this.value.replace(/\++/,"+"))this.value="+";else{const e=Object(a.c)(this.value);o=e.formatted,i=e.country,this.value=V=o?"+"+o:""}let s=i?i.name:"";s===K.value||t&&i&&t.phoneCode===i.phoneCode||(K.value=s,t=i),i||this.value.length-1>1?R.style.visibility="":R.style.visibility="hidden"})),F.addEventListener("paste",e=>{U=!0}),F.addEventListener("keypress",(function(e){return R.style.visibility||"Enter"!==e.key?!/\D/.test(e.key)||e.metaKey||e.ctrlKey||"Backspace"===e.key||"+"===e.key&&e.shiftKey?void 0:(e.preventDefault(),!1):Y()}));const G=new u.a({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});G.input.addEventListener("change",()=>{const e=G.checked;s.default.pushToState("keepSigned",e),k.a.toggleStorage(e),O.a.toggleStorage(e),c.a.toggleStorage(e),A.a.toggleStorage(e)}),s.default.getState().then(e=>{s.default.storage.isAvailable()?G.checked=e.keepSigned:(G.checked=!1,G.label.classList.add("checkbox-disabled"))}),R=Object(p.a)("btn-primary btn-color-primary",{text:"Login.Next"}),R.style.visibility="hidden";const Y=e=>{e&&Object(x.a)(e);const t=Object(N.a)([R,P],!0);Object(_.a)(R,Object(g.i18n)("PleaseWait")),Object(a.f)(R);let o=F.value;c.a.invokeApi("auth.sendCode",{phone_number:o,api_id:v.a.id,api_hash:v.a.hash,settings:{_:"codeSettings"}}).then(e=>{n.e(23).then(n.bind(null,21)).then(t=>t.default.mount(Object.assign(e,{phone_number:o})))}).catch(e=>{switch(t(),e.type){case"PHONE_NUMBER_INVALID":$.setError(),Object(_.a)($.label,Object(g.i18n)("Login.PhoneLabelInvalid")),F.classList.add("error"),Object(_.a)(R,Object(g.i18n)("Login.Next"));break;default:console.error("auth.sendCode error:",e),R.innerText=e.type}})};Object(C.b)(R,Y),P=Object(p.a)("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"});P.addEventListener("click",()=>{S.default.mount()}),r.append(L.container,$.container,G.label,R,P);const Z=document.createElement("h4");Object(g._i18n)(Z,"Login.Title");const ee=document.createElement("div");ee.classList.add("subtitle"),Object(g._i18n)(ee,"Login.StartText"),D.pageEl.querySelector(".container").append(Z,ee,r);m.isTouchSupported||setTimeout(()=>{F.focus()},0),Object(T.a)(r),c.a.invokeApi("help.getNearestDc").then(e=>{const t=new Set([1,2,3,4,5]),n=[e.this_dc];let a;return e.nearest_dc!==e.this_dc&&(a=c.a.getNetworker(e.nearest_dc).then(()=>{n.push(e.nearest_dc)})),(a||Promise.resolve()).then(()=>{n.forEach(e=>{t.delete(e)});const e=[...t],a=()=>I(void 0,void 0,void 0,(function*(){const t=e.shift();if(!t)return;const n=`dc${t}_auth_key`;if(yield A.a.get(n))return a();setTimeout(()=>{c.a.getNetworker(t).finally(a)},3e3)}));a()}),e}).then(n=>{let a=e.find(e=>e.code===n.country);a&&(K.value.length||F.value.length||(K.value=a.name,t=a,F.value=V="+"+a.phoneCode.split(" and ").shift()))})},()=>{R&&(Object(_.a)(R,Object(g.i18n)("Login.Next")),Object(L.ripple)(R,void 0,void 0,!0),R.removeAttribute("disabled")),P&&P.removeAttribute("disabled"),s.default.pushToState("authState",{_:"authStateSignIn"})});t.default=D}}]);
//# sourceMappingURL=29.ceaaaa3f03132c68bcaf.chunk.js.map