(this.webpackJsonp=this.webpackJsonp||[]).push([[16,20],{20:function(t,e,i){"use strict";i.r(e);var n=i(35),s=i(38),a=i(16),r=i(77),o=i(61),l=i(32),c=i(88),u=i(95),h=i(28),d=i(14),p=i(80),m=i(4),b=i(30),g=i(103),f=i(33),w=i(49);let v;const y=new o.a("page-password",!0,()=>{const t=new p.a({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"}),e=Object(l.a)("btn-primary btn-color-primary"),a=new d.default.IntlElement({key:"Login.Next"});e.append(a.element);const o=new c.a({label:"LoginPassword",name:"password"});let y;v=o.input,t.inputWrapper.append(o.container,e);let E,L=()=>(y||(y=window.setInterval(L,1e4)),r.a.getState().then(t=>{E=t,E.hint?Object(f.a)(o.label,Object(g.a)(h.b.wrapEmojiText(E.hint))):o.setLabel()}));const k=t=>{if(t&&Object(m.a)(t),!v.value.length)return void v.classList.add("error");const s=Object(w.a)([v,e],!0);let l=v.value;a.update({key:"PleaseWait"});const c=Object(n.g)(e);r.a.check(l,E).then(t=>{switch(t._){case"auth.authorization":clearInterval(y),i.e(5).then(i.bind(null,18)).then(t=>{t.default.mount()}),P&&P.remove();break;default:e.removeAttribute("disabled"),a.update({key:t._}),c.remove()}}).catch(t=>{s(),o.input.classList.add("error"),t.type,a.update({key:"PASSWORD_HASH_INVALID"}),v.select(),c.remove(),L()})};Object(b.b)(e,k),v.addEventListener("keypress",(function(t){if(this.classList.remove("error"),a.update({key:"Login.Next"}),"Enter"===t.key)return k()}));const N=s.b.isMobile?100:166,P=new u.a(o,N);return t.imageDiv.append(P.container),Promise.all([P.load(),L()])},null,()=>{v.focus(),a.default.pushToState("authState",{_:"authStatePassword"})});e.default=y},33:function(t,e,i){"use strict";function n(t,e){if("string"==typeof e)return void(t.innerHTML=e);const i=t.firstChild;i?t.lastChild===i?i.replaceWith(e):(t.textContent="",t.append(e)):t.append(e)}i.d(e,"a",(function(){return n}))},36:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i(66),s=i(45),a=i(67),r=i(14),o=i(28);let l=()=>{document.addEventListener("paste",t=>{if(!Object(n.a)(t.target,'contenteditable="true"'))return;t.preventDefault();let e=(t.originalEvent||t).clipboardData.getData("text/plain"),i=o.b.parseEntities(e);i=i.filter(t=>"messageEntityEmoji"===t._||"messageEntityLinebreak"===t._),e=o.b.wrapRichText(e,{entities:i,noLinks:!0,wrappingDraft:!0}),window.document.execCommand("insertHTML",!1,e)}),l=null};var c;!function(t){t[t.Neutral=0]="Neutral",t[t.Valid=1]="Valid",t[t.Error=2]="Error"}(c||(c={}));e.b=class{constructor(t={}){this.options=t,this.container=document.createElement("div"),this.container.classList.add("input-field"),t.maxLength&&(t.showLengthOn=Math.min(40,Math.round(t.maxLength/3)));const{placeholder:e,maxLength:i,showLengthOn:n,name:o,plainText:c}=t;let u,h,d=t.label||t.labelText;if(c)this.container.innerHTML=`\n      <input type="text" ${o?`name="${o}"`:""} autocomplete="off" ${d?'required=""':""} class="input-field-input">\n      `,u=this.container.firstElementChild;else{l&&l(),this.container.innerHTML='\n      <div contenteditable="true" class="input-field-input"></div>\n      ',u=this.container.firstElementChild;const e=new MutationObserver(()=>{h&&h()});u.addEventListener("input",()=>{Object(a.a)(u)&&(u.innerHTML=""),this.inputFake&&(this.inputFake.innerHTML=u.innerHTML,this.onFakeInput())}),e.observe(u,{characterData:!0,childList:!0,subtree:!0}),t.animate&&(u.classList.add("scrollable","scrollable-y"),this.wasInputFakeClientHeight=0,this.inputFake=document.createElement("div"),this.inputFake.setAttribute("contenteditable","true"),this.inputFake.className=u.className+" input-field-input-fake")}if(u.setAttribute("dir","auto"),e&&(Object(r._i18n)(u,e,void 0,"placeholder"),this.inputFake&&Object(r._i18n)(this.inputFake,e,void 0,"placeholder")),d||e){const t=document.createElement("div");t.classList.add("input-field-border"),this.container.append(t)}if(d&&(this.label=document.createElement("label"),this.setLabel(),this.container.append(this.label)),i){const t=this.container.lastElementChild;let e=!1;h=()=>{const a=u.classList.contains("error"),r=c?u.value.length:[...Object(s.a)(u,!1).value].length,o=i-r,l=o<0;u.classList.toggle("error",l),l||o<=n?(this.setLabel(),t.append(` (${i-r})`),e||(e=!0)):(a&&!l||e)&&(this.setLabel(),e=!1)},u.addEventListener("input",h)}this.input=u}select(){this.input.value&&this.input.select()}setLabel(){this.label.textContent="",this.options.labelText?this.label.innerHTML=this.options.labelText:this.label.append(Object(r.i18n)(this.options.label,this.options.labelOptions))}onFakeInput(){const{scrollHeight:t,clientHeight:e}=this.inputFake;this.wasInputFakeClientHeight=e,this.input.style.height=t?t+"px":""}get value(){return this.options.plainText?this.input.value:Object(s.a)(this.input,!1).value}set value(t){this.setValueSilently(t,!1);const e=new Event("input",{bubbles:!0,cancelable:!0});this.input.dispatchEvent(e)}setValueSilently(t,e=!0){this.options.plainText?this.input.value=t:(this.input.innerHTML=t,this.inputFake&&(this.inputFake.innerHTML=t,e&&this.onFakeInput()))}isValid(){return!this.input.classList.contains("error")&&this.value!==this.originalValue}setOriginalValue(t="",e=!1){this.originalValue=t,this.options.plainText||(t=o.b.wrapDraftText(t)),e?this.setValueSilently(t,!1):this.value=t}setState(t,e){e&&(this.label.textContent="",this.label.append(Object(r.i18n)(e,this.options.labelOptions))),this.input.classList.toggle("error",!!(t&c.Error)),this.input.classList.toggle("valid",!!(t&c.Valid))}setError(t){this.setState(c.Error,t)}}},45:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(27),s=i(28),a=i(64);function r(t,e=!0){const i=[],n=[],r=e?[]:void 0;Object(a.a)(t,i,n,void 0,void 0,r),n.length&&i.push(n.join(""));let o=i.join("\n");return o=o.replace(/\u00A0/g," "),r&&s.b.combineSameEntities(r),{value:o,entities:r}}n.a.getRichValue=r},49:function(t,e,i){"use strict";function n(t,e){return e?t.forEach(t=>t.setAttribute("disabled","true")):t.forEach(t=>t.removeAttribute("disabled")),()=>n(t,!e)}i.d(e,"a",(function(){return n}))},64:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return s}));const n={bold:{match:'[style*="font-weight"], b',entityName:"messageEntityBold"},underline:{match:'[style*="underline"], u',entityName:"messageEntityUnderline"},italic:{match:'[style*="italic"], i',entityName:"messageEntityItalic"},monospace:{match:'[style*="monospace"], [face="monospace"], pre',entityName:"messageEntityPre"},strikethrough:{match:'[style*="line-through"], strike',entityName:"messageEntityStrike"},link:{match:"A:not(.follow)",entityName:"messageEntityTextUrl"},mentionName:{match:"A.follow",entityName:"messageEntityMentionName"}};function s(t,e,i,a,r,o,l={offset:0}){if(3===t.nodeType){const e=t.nodeValue;if(a===t?i.push(e.substr(0,r)+""+e.substr(r)):i.push(e),o&&e.trim()&&t.parentNode){const i=t.parentElement;for(const t in n){const s=n[t],a=i.closest(s.match+", [contenteditable]");a&&null===a.getAttribute("contenteditable")&&("messageEntityTextUrl"===s.entityName?o.push({_:s.entityName,url:i.href,offset:l.offset,length:e.length}):"messageEntityMentionName"===s.entityName?o.push({_:s.entityName,offset:l.offset,length:e.length,user_id:+i.dataset.follow}):o.push({_:s.entityName,offset:l.offset,length:e.length}))}}return void(l.offset+=e.length)}if(1!==t.nodeType)return;const c=a===t,u="DIV"===t.tagName||"P"===t.tagName;if(u&&i.length||"BR"===t.tagName)e.push(i.join("")),i.splice(0,i.length);else if("IMG"===t.tagName){const e=t.alt;e&&(i.push(e),l.offset+=e.length)}c&&!r&&i.push("");let h=t.firstChild;for(;h;)s(h,e,i,a,r,o,l),h=h.nextSibling;c&&r&&i.push(""),u&&i.length&&(e.push(i.join("")),i.splice(0,i.length))}},66:function(t,e,i){"use strict";function n(t,e){return t.closest(`[${e}]`)}i.d(e,"a",(function(){return n}))},67:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(45);function s(t){return t.hasAttribute("contenteditable")||"INPUT"!==t.tagName?!Object(n.a)(t,!1).value.trim():!t.value.trim()}},77:function(t,e,i){"use strict";var n=i(27),s=i(34),a=i(29);const r=new class{getState(){return a.a.invokeApi("account.getPassword").then(t=>t)}updateSettings(t={}){return this.getState().then(e=>{let i,n;const s={password:null,new_settings:{_:"account.passwordInputSettings",hint:t.hint,email:t.email}};i=t.currentPassword?a.a.invokeCrypto("computeSRP",t.currentPassword,e,!1):Promise.resolve({_:"inputCheckPasswordEmpty"});const r=e.new_algo,o=new Uint8Array(r.salt1.length+32);return o.randomize(),o.set(r.salt1,0),r.salt1=o,n=t.newPassword?a.a.invokeCrypto("computeSRP",t.newPassword,e,!0):Promise.resolve(new Uint8Array),Promise.all([i,n]).then(t=>(s.password=t[0],s.new_settings.new_algo=r,s.new_settings.new_password_hash=t[1],a.a.invokeApi("account.updatePasswordSettings",s)))})}check(t,e,i={}){return a.a.invokeCrypto("computeSRP",t,e,!1).then(t=>a.a.invokeApi("auth.checkPassword",{password:t},i).then(t=>("auth.authorization"===t._&&(s.a.saveApiUser(t.user),a.a.setUserAuth(t.user.id)),t)))}confirmPasswordEmail(t){return a.a.invokeApi("account.confirmPasswordEmail",{code:t})}resendPasswordEmail(){return a.a.invokeApi("account.resendPasswordEmail")}cancelPasswordEmail(){return a.a.invokeApi("account.cancelPasswordEmail")}};n.a.passwordManager=r,e.a=r},80:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(14);class s{constructor(t){this.element=document.body.querySelector("."+t.className),this.container=document.createElement("div"),this.container.className="container center-align",this.imageDiv=document.createElement("div"),this.imageDiv.className="auth-image",this.title=document.createElement("h4"),t.titleLangKey&&this.title.append(Object(n.i18n)(t.titleLangKey)),this.subtitle=document.createElement("p"),this.subtitle.className="subtitle",t.subtitleLangKey&&this.subtitle.append(Object(n.i18n)(t.subtitleLangKey)),this.container.append(this.imageDiv,this.title,this.subtitle),t.withInputWrapper&&(this.inputWrapper=document.createElement("div"),this.inputWrapper.className="input-wrapper",this.container.append(this.inputWrapper)),this.element.append(this.container)}}},88:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(4),s=i(36);class a extends s.b{constructor(t={}){super(Object.assign({plainText:!0},t)),this.passwordVisible=!1,this.onVisibilityClick=t=>{Object(n.a)(t),this.passwordVisible=!this.passwordVisible,this.toggleVisible.classList.toggle("eye-hidden",this.passwordVisible),this.input.type=this.passwordVisible?"text":"password",this.onVisibilityClickAdditional&&this.onVisibilityClickAdditional()};const e=this.input;e.type="password",e.setAttribute("required",""),e.autocomplete="off";const i=document.createElement("input");i.classList.add("stealthy"),i.tabIndex=-1,i.type="password",e.parentElement.prepend(i),e.parentElement.insertBefore(i.cloneNode(),e.nextSibling);const s=this.toggleVisible=document.createElement("span");s.classList.add("toggle-visible","tgico"),this.container.classList.add("input-field-password"),this.container.append(s),s.addEventListener("click",this.onVisibilityClick),s.addEventListener("touchend",this.onVisibilityClick)}}},95:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(47);class s{constructor(t,e){this.passwordInputField=t,this.size=e,this.needFrame=0,this.container=document.createElement("div"),this.container.classList.add("media-sticker-wrapper")}load(){return this.loadPromise?this.loadPromise:this.loadPromise=n.b.loadAnimationFromURL({container:this.container,loop:!1,autoplay:!1,width:this.size,height:this.size,noCache:!0},"assets/img/TwoFactorSetupMonkeyPeek.tgs").then(t=>(this.animation=t,this.animation.addEventListener("enterFrame",t=>{(1===this.animation.direction&&t>=this.needFrame||-1===this.animation.direction&&t<=this.needFrame)&&(this.animation.setSpeed(1),this.animation.pause())}),this.passwordInputField.onVisibilityClickAdditional=()=>{this.passwordInputField.passwordVisible?(this.animation.setDirection(1),this.animation.curFrame=0,this.needFrame=16,this.animation.play()):(this.animation.setDirection(-1),this.animation.curFrame=16,this.needFrame=0,this.animation.play())},n.b.waitForFirstFrame(t)))}remove(){this.animation&&this.animation.remove()}}}}]);
//# sourceMappingURL=16.59c430acd3fb853ebd6e.chunk.js.map