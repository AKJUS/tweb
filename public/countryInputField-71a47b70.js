import{r as D}from"./button-04b8fd0a.js";import{bn as N,b as R,d as A,a as T,e as I,aq as B,Z as K,ag as F,r as O,i as L,L as x,aX as j,v as w,c as H}from"./index-96b72b56.js";import{s as U,e as W}from"./page-77588a87.js";import{I as V,p as X,r as P,ac as q,w as z,x as J}from"./wrapEmojiText-6cdeb588.js";import{S as Z}from"./scrollable-f4324fdc.js";function G(f,e){const t=Array.isArray(e)?e:e.split(N);let s=f;for(const c of t)if(s=s?.[c],!s)break;return s}class ne{constructor(e={}){const t=this.label=document.createElement("label");t.classList.add("checkbox-field"),e.restriction&&!e.toggle&&t.classList.add("checkbox-field-restriction"),e.round&&t.classList.add("checkbox-field-round"),e.disabled&&this.toggleDisability(!0),this.listenerSetter=e.listenerSetter;const s=this.input=document.createElement("input");if(s.classList.add("checkbox-field-input"),s.type=e.asRadio?"radio":"checkbox",e.name&&(s[e.asRadio?"name":"id"]="input-"+e.name),e.checked&&(s.checked=!0),e.stateKey){let n=e.checked!==void 0;const d=()=>{if(!n)return;let i;e.stateValues?i=e.stateValues[s.checked?1:0]:(i=s.checked,e.stateValueReverse&&(i=!i)),T.managers.appStateManager.setByKey(e.stateKey,i)};!n&&R.getState().then(i=>{n=!0;const m=G(i,e.stateKey);let a;e.stateValues?a=e.stateValues.indexOf(m)===1:(a=m,e.stateValueReverse&&(a=!a)),this.setValueSilently(a)}),e.listenerSetter?e.listenerSetter.add(s)("change",d):s.addEventListener("change",d)}let c;if(e.text?(c=this.span=document.createElement("span"),c.classList.add("checkbox-caption"),A(c,e.text,e.textArgs)):t.classList.add("checkbox-without-caption"),t.append(s),e.toggle){t.classList.add("checkbox-field-toggle"),e.restriction&&t.classList.add("checkbox-field-toggle-restriction");const n=document.createElement("div");n.classList.add("checkbox-toggle"),t.append(n)}else{const n=document.createElement("div");n.classList.add("checkbox-box");const d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.classList.add("checkbox-box-check"),d.setAttributeNS(null,"viewBox","0 0 24 24");const i=document.createElementNS("http://www.w3.org/2000/svg","use");i.setAttributeNS(null,"href","#check"),i.setAttributeNS(null,"x","-1"),d.append(i);const m=document.createElement("div");m.classList.add("checkbox-box-background");const a=document.createElement("div");a.classList.add("checkbox-box-border"),n.append(a,m,d),t.append(n)}c&&t.append(c),e.withRipple?(t.classList.add("checkbox-ripple","hover-effect"),D(t,void 0,void 0,!0)):e.withHover&&t.classList.add("hover-effect")}get checked(){return this.input.checked}set checked(e){this.setValueSilently(e),U(this.input,"change")}setValueSilently(e){this.input.checked=e}isDisabled(){return this.label.classList.contains("checkbox-disabled")}toggleDisability(e){return this.label.classList.toggle("checkbox-disabled",e),this.input.disabled=e,()=>this.toggleDisability(!e)}}const k=new Map;let S=0;const _=(f,e,t="")=>{t=e.country_code+t,S=Math.max(S,t.length),k.set(t,{country:f,code:e})};function Q(f){f=f||"",k.size||I.countriesList.forEach(r=>{r.country_codes.forEach(l=>{l.prefixes?l.prefixes.forEach(o=>{_(r,l,o)}):_(r,l)})});let e=f.replace(/\D/g,"");const t=e.slice(0,S);let s;for(let r=t.length-1;r>=0&&(s=k.get(t.slice(0,r+1)),!s);--r);if(!s)return{formatted:e,country:void 0,code:void 0,leftPattern:""};const c=s.country,n=s.code.patterns||[],d=e.slice(s.code.country_code.length);let i="",m=0,a="";for(let r=n.length-1;r>=0;--r){i=n[r];const l=i.replace(/ /g,"");let o=0;for(let h=0,p=Math.min(d.length,l.length);h<p;++h)if(d[h]===l[h])o+=1.01;else if(l[h]==="X")++o;else{o=0;break}o>m&&(m=o,a=i)}i=a||i,i=i.replace(/\d/g,"X"),i=s.code.country_code+" "+i,i.split("").forEach((r,l)=>{r===" "&&e[l]!==" "&&e.length>l&&(e=e.slice(0,l)+" "+e.slice(l))});let u=i&&i.length>e.length?i.slice(e.length):"";return u&&(u=u.replace(/X/g,"â€’")),{formatted:e,country:c,code:s.code,leftPattern:u}}class ie extends V{constructor(e={}){super({label:"Contacts.PhoneNumber.Placeholder",name:"phone",...e}),this.pasted=!1,this.lastValue="",this.container.classList.add("input-field-phone");const t=this.input;if(t instanceof HTMLInputElement)t.type="tel",t.autocomplete="rr55RandomRR55";else{t.inputMode="decimal";const s=window.devicePixelRatio;if(s>1){let n;K?n=s*-.16:F&&(n=0),t.style.setProperty("--letter-spacing",n+"px")}const c=this.setValueSilently.bind(this);this.setValueSilently=n=>{c(n),X(this.input,!0)}}t.addEventListener("input",()=>{t.classList.remove("error");const s=this.value;Math.abs(s.length-this.lastValue.length)>1&&!this.pasted&&B&&this.setValueSilently(this.lastValue+s),this.pasted=!1,this.setLabel();let n,d,i="";this.value.replace(/\++/,"+")==="+"?this.setValueSilently("+"):(n=Q(this.value),d=n.formatted,n.country,i=n.leftPattern,n.code,this.setValueSilently(this.lastValue=d?"+"+d:"")),t.dataset.leftPattern=i,e.onInput&&e.onInput(n)}),t.addEventListener("paste",()=>{this.pasted=!0}),t.addEventListener("keypress",s=>{const c=s.key;if(/\D/.test(c)&&!(s.metaKey||s.ctrlKey)&&c!=="Backspace"&&!(c==="+"&&s.shiftKey))return s.preventDefault(),!1})}}let b;const M=()=>{b=I.countriesList.filter(f=>!f.pFlags?.hidden).sort((f,e)=>(f.name||f.default_name).localeCompare(e.name||e.default_name))};let C=()=>{M(),T.addEventListener("language_change",()=>{M()})};const Y=new Set(["FT"]);class le extends V{constructor(e={}){super({label:"Country",name:O(),...e}),this.options=e,this.hidePicker=()=>{this.hideTimeout===void 0&&(this.selectWrapper.classList.remove("active"),this.hideTimeout=window.setTimeout(()=>{this.selectWrapper.classList.add("hide"),this.hideTimeout=void 0},200))},this.selectCountryByTarget=a=>{const u=a.querySelector("[data-default-name]").dataset.defaultName,l=a.querySelector(".phone-code")?.innerText,o=l&&l.replace(/\D/g,"");P(this.input,L(u)),this.simulateInputEvent(),this.lastCountrySelected=b.find(h=>h.default_name===u),this.lastCountryCodeSelected=o&&this.lastCountrySelected.country_codes.find(h=>h.country_code===o),this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected),this.hidePicker()},C&&(C(),C=void 0),this.liMap=new Map,this.container.classList.add("input-select");const t=this.selectWrapper=document.createElement("div");t.classList.add("select-wrapper","z-depth-3","hide");const s=document.createElement("span");s.classList.add("arrow","arrow-down"),this.container.append(s);const c=document.createElement("ul");t.appendChild(c),new Z(t);let n=()=>{n=null,b.forEach(a=>{if(e.noPhoneCodes&&Y.has(a.iso2))return;const u=q(a.iso2),r=[];for(let l=0,o=Math.min(a.country_codes.length,e.noPhoneCodes?1:1/0);l<o;++l){const h=a.country_codes[l],p=document.createElement("li"),E=z(u);if(j){const g=document.createElement("span");w(g,E),p.append(g)}else w(p,E);const y=L(a.default_name);if(y.dataset.defaultName=a.default_name,p.append(y),!e.noPhoneCodes){const g=document.createElement("span");g.classList.add("phone-code"),g.innerText="+"+h.country_code,p.appendChild(g)}r.push(p),c.append(p)}this.liMap.set(a.iso2,r)}),c.addEventListener("mousedown",a=>{if(a.button!==0)return;const u=J(a.target,"LI");this.selectCountryByTarget(u)}),this.container.appendChild(t)};n(),this.input.addEventListener("focus",a=>{n?n():b.forEach(u=>{const r=this.liMap.get(u.iso2);r&&r.forEach(l=>l.style.display="")}),clearTimeout(this.hideTimeout),this.hideTimeout=void 0,t.classList.remove("hide"),t.offsetWidth,t.classList.add("active"),this.select(),W({container:x(this.container,"scrollable-y"),element:this.input,position:"start",margin:4}),setTimeout(()=>{d||(document.addEventListener("mousedown",i,{capture:!0}),d=!0)},0)});let d=!1;const i=a=>{x(a.target,"input-select")||a.target!==this.input&&(this.hidePicker(),document.removeEventListener("mousedown",i,{capture:!0}),d=!1)},m=a=>{const u=a.key;if(a.ctrlKey||u==="Control")return!1;const r=this.value.toLowerCase(),l=[];b.forEach(o=>{const h=this.liMap.get(o.iso2);if(!h)return;const p=[o.name,o.default_name,o.iso2];p.filter(Boolean).forEach(y=>{const g=y.split(" ").filter(v=>/\w/.test(v)).map(v=>v[0]).join("");g.length>1&&p.push(g)});const E=!!p.filter(Boolean).find(y=>y.toLowerCase().indexOf(r)!==-1);h.forEach(y=>y.style.display=E?"":"none"),E&&l.push(o)}),l.length===0?b.forEach(o=>{const h=this.liMap.get(o.iso2);h&&h.forEach(p=>p.style.display="")}):l.length===1&&u==="Enter"&&(H(a),this.selectCountryByTarget(this.liMap.get(l[0].iso2)[0]))};this.input.addEventListener("keyup",m),this.input.addEventListener("keydown",a=>{a.key==="Enter"&&m(a)}),s.addEventListener("mousedown",a=>{this.input.matches(":focus")?(this.hidePicker(),this.input.blur()):(a.cancelBubble=!0,a.preventDefault(),this.input.focus())})}getSelected(){return{country:this.lastCountrySelected,code:this.lastCountryCodeSelected}}selectCountryByIso2(e){this.selectCountryByTarget(this.liMap.get(e)[0])}override(e,t,s){P(this.input,e?L(e.default_name):s),this.lastCountrySelected=e,this.lastCountryCodeSelected=t,this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected)}}export{le as C,ie as T,ne as a,Q as f,G as g};
//# sourceMappingURL=countryInputField-71a47b70.js.map
